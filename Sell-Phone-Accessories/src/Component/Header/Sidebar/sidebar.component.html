<nav class="nav" role="navigation" aria-label="Main">
  <!-- ===== DESKTOP (≥992px): menu ngang + MatMenu ===== -->
  <ul class="nav-list desktop-only">
    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">
        Cases
      </button>
      <div class="dropdown" role="menu" aria-label="Cases mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of products">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
               [queryParams]="{ category: 'Cases', model: p.name }"
              (click)="isOn = !isOn; getInformation(p.name, 'Cases')"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>

    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">
        Screen Protection
      </button>
      <div class="dropdown" role="menu" aria-label="Screen Protection mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of screenProtection">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
               [queryParams]="{ category: 'Screen Protection', model: p.name }"
              (click)="isOn = !isOn; getInformation(p.name, 'Screen Protection')"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>

    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">
        Power
      </button>
      <div class="dropdown" role="menu" aria-label="Power mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of power">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
                [queryParams]="{ category: 'Power', model: p.name }"
              (click)="isOn = !isOn"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>
    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">
        Accessories
      </button>
      <div class="dropdown" role="menu" aria-label="Power mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of power">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
              (click)="isOn = !isOn"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>

    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">
        Customize
      </button>
      <div class="dropdown" role="menu" aria-label="Power mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of power">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
              (click)="isOn = !isOn"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>

    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">Sale</button>
      <div class="dropdown" role="menu" aria-label="Power mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of power">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
              (click)="isOn = !isOn"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>

    <li class="nav-item mega">
      <button type="button" class="trigger" (click)="isOn = false">
        Explore
      </button>
      <div class="dropdown" role="menu" aria-label="Power mega">
        <div class="mega" [class.display]="isOn">
          <div class="col" *ngFor="let cat of power">
            <h4>{{ cat.title }}</h4>
            <a
              class="item"
              *ngFor="let p of cat.product"
              [routerLink]="['/product']"
              (click)="isOn = !isOn"
              [attr.id]="p.id"
            >
              {{ p.name }}
            </a>
          </div>
        </div>
      </div>
    </li>
  </ul>

  <!-- ===== MOBILE (<992px): hamburger + drawer trượt từ trái ===== -->
  <div class="mobile-only mobile-bar">
    <button
      mat-icon-button
      type="button"
      class="hamburger"
      (click)="drawer.toggle()"
      [attr.aria-expanded]="drawer?.opened"
      aria-label="Mở menu"
      aria-controls="mobile-drawer"
    >
      <mat-icon>menu</mat-icon>
    </button>
    <a class="logo" routerLink="/">BRAND</a>
  </div>

  <mat-sidenav-container
    class="mobile-only"
    [class.drawer-container]="drawer?.opened"
    [hasBackdrop]="true"
  >
    <!-- exportAs để template var đúng là MatSidenav -->
    <mat-sidenav
      #drawer="matSidenav"
      id="mobile-drawer"
      mode="over"
      position="start"
      [autoFocus]="false"
      [disableClose]="false"
    >
      <div class="drawer-head">
        <span class="logo">Menu</span>
        <button
          mat-icon-button
          type="button"
          (click)="drawer.close()"
          aria-label="Đóng menu"
        >
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <mat-nav-list>
        <!-- Cases: mở rộng ra danh sách -->
        <mat-expansion-panel
          class="exp"
          [expanded]="expanded === 'cases'"
          (opened)="expanded = 'cases'"
          (closed)="expanded = null"
        >
          <mat-expansion-panel-header>
            <mat-panel-title>Cases</mat-panel-title>
          </mat-expansion-panel-header>

          <div class="exp-cols">
            <div class="exp-col" *ngFor="let cat of products">
              <h4>{{ cat.title }}</h4>
              <a
                mat-list-item
                *ngFor="let p of cat.product"
                [routerLink]="['/product']"
                (click)="layId(); drawer.close()"
              >
                {{ p.name }}
              </a>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- Các mục còn lại -->
        <a
          mat-list-item
          [routerLink]="['/screen-protection']"
          (click)="drawer.close()"
          >Screen Protection</a
        >
        <a mat-list-item [routerLink]="['/wearables']" (click)="drawer.close()"
          >Wearables</a
        >
        <a mat-list-item [routerLink]="['/the-drop']" (click)="drawer.close()"
          >The Drop</a
        >
        <a mat-list-item [routerLink]="['/power']" (click)="drawer.close()"
          >Power</a
        >
        <a
          mat-list-item
          [routerLink]="['/accessories']"
          (click)="drawer.close()"
          >Accessories</a
        >
        <a mat-list-item [routerLink]="['/customize']" (click)="drawer.close()"
          >Customize</a
        >
        <a mat-list-item [routerLink]="['/sale']" (click)="drawer.close()"
          >Sale</a
        >
        <a mat-list-item [routerLink]="['/explore']" (click)="drawer.close()"
          >Explore</a
        >
      </mat-nav-list>
    </mat-sidenav>
  </mat-sidenav-container>
</nav>
